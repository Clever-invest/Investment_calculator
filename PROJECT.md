# Flip Calculator ‚Äî Investment Property Calculator

> **–í–µ—Ä—Å–∏—è:** 2.2.0  
> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 15 –¥–µ–∫–∞–±—Ä—è 2025  
> **–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready

---

## üìä –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å: 100%

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à—ë–Ω –∏ –≥–æ—Ç–æ–≤ –∫ production.

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã

### –≠—Ç–∞–ø 1: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ App.jsx ‚úÖ
- App.tsx: 1984 ‚Üí ~500 —Å—Ç—Ä–æ–∫ (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ 75%)
- –í—ã–Ω–µ—Å–µ–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ–æ—Ä–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –ø—Ä–æ–µ–∫—Ç–æ–≤
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –≠—Ç–∞–ø 2: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ TypeScript ‚úÖ
- 100% —Ñ–∞–π–ª–æ–≤ –Ω–∞ TypeScript
- –ü–æ–ª–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç, —Ä–∞—Å—á—ë—Ç–æ–≤
- –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è Supabase (database.ts)

### –≠—Ç–∞–ø 3: Tailwind CSS ‚úÖ
- –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–±–µ–∑ CDN)
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è –º–µ—Ç—Ä–∏–∫ (profit, roi, irr, timing)
- shadcn/ui –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –≠—Ç–∞–ø 4: State Management ‚úÖ
- Zustand stores —Å persist
- calculatorStore, propertiesStore, uiStore, authStore
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –æ–±–ª–∞–∫–æ–º

### –≠—Ç–∞–ø 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ
- Unit —Ç–µ—Å—Ç—ã (Vitest)
- E2E —Ç–µ—Å—Ç—ã (Playwright)
- CI/CD –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### –≠—Ç–∞–ø 6: Backend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚úÖ
- Supabase Auth (email/password)
- PostgreSQL —Å RLS –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏
- Supabase Storage –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- Realtime —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### –≠—Ç–∞–ø 7: PWA –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è ‚úÖ
- Service Worker (Workbox)
- Offline-first architecture
- Code splitting, lazy loading
- Skeleton loaders

---

## üöß –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (15 –¥–µ–∫–∞–±—Ä—è 2025)

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Notion
- [x] Edge Function `sync-to-notion` v15
- [x] Database Trigger –Ω–∞ INSERT/UPDATE/DELETE
- [x] –ü–æ–ª–µ `notion_page_id` –≤ —Ç–∞–±–ª–∏—Ü–µ properties
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Place property —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
- [x] –í—Å–µ —Ñ–æ—Ç–æ –ø—Ä–∏–∫—Ä–µ–ø–ª—è—é—Ç—Å—è –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- [x] ROI/IRR –≤ —Ñ–æ—Ä–º–∞—Ç–µ Percent
- [x] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è `serial_number` ‚Üí `Slot ID` –≤ Notion

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: `docs/NOTION_SYNC_SETUP.md`

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ auth/           # AuthModal, UserMenu, ProtectedRoute
‚îÇ   ‚îú‚îÄ‚îÄ forms/          # PropertyInfoForm, DealParamsForm, ImageUploader
‚îÇ   ‚îú‚îÄ‚îÄ layout/         # BottomNav
‚îÇ   ‚îú‚îÄ‚îÄ projects/       # SavedPropertiesList, DealSheetExport
‚îÇ   ‚îú‚îÄ‚îÄ results/        # MetricsGrid, WaterfallChart, DetailedBreakdown
‚îÇ   ‚îú‚îÄ‚îÄ shared/         # MetricCard, Skeleton, OfflineIndicator
‚îÇ   ‚îî‚îÄ‚îÄ ui/             # shadcn/ui –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ hooks/              # useCalculations, useAuth, useMediaQuery
‚îú‚îÄ‚îÄ pages/              # AuthPage, ResetPasswordPage
‚îú‚îÄ‚îÄ services/           # propertiesApi, storage, location
‚îú‚îÄ‚îÄ stores/             # Zustand: calculator, properties, ui, auth
‚îú‚îÄ‚îÄ types/              # calculator.ts, database.ts
‚îî‚îÄ‚îÄ utils/              # format, haptic
```

---

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| Frontend | React 18, TypeScript, Vite |
| Styling | Tailwind CSS, shadcn/ui |
| State | Zustand + persist |
| Backend | Supabase (Auth, DB, Storage) |
| Charts | Recharts |
| Maps | OpenStreetMap + Leaflet |
| PWA | Workbox, vite-plugin-pwa |
| Testing | Vitest, Playwright |

---

## üìù –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Supabase

### –¢–∞–±–ª–∏—Ü–∞ `properties`
```sql
id              UUID PRIMARY KEY
user_id         UUID REFERENCES auth.users
name            TEXT NOT NULL
location        TEXT
deal_type       TEXT DEFAULT 'secondary'
params          JSONB -- –≤—Å–µ CalculatorParams –≤–∫–ª—é—á–∞—è bedrooms, bathrooms
calculations    JSONB
coordinates     JSONB
images          TEXT[]
notes           TEXT
serial_number   TEXT -- –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä (SL-001, SL-002, ...)
is_archived     BOOLEAN DEFAULT false
notion_page_id  TEXT -- ID —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ Notion –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
created_at      TIMESTAMPTZ
updated_at      TIMESTAMPTZ
```

### Edge Functions

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `sync-to-notion` | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å Notion Project Pipeline |

### Database Triggers

| –¢—Ä–∏–≥–≥–µ—Ä | –°–æ–±—ã—Ç–∏—è | –î–µ–π—Å—Ç–≤–∏–µ |
|--------|----------|----------|
| `trigger_notion_sync` | INSERT/UPDATE/DELETE | –í—ã–∑—ã–≤–∞–µ—Ç Edge Function sync-to-notion |

---

## üöÄ –ó–∞–ø—É—Å–∫

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
npm install

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run dev

# –°–±–æ—Ä–∫–∞
npm run build

# –¢–µ—Å—Ç—ã
npm test
npm run test:e2e
```

---

## üìå Backlog

- [ ] Google OAuth
- [ ] Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ side-by-side
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
- [ ] –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å (EN/RU/AR)
